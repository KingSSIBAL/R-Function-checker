---
title: "Student Guide"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Student Guide}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  eval = FALSE
)
```

## Overview

This guide explains how to use the autograder package to test your R 
programming assignments. The autograder provides immediate feedback on your 
code, helping you learn and improve.

## Workflow Summary

1. **Discover** available problems with `list_problems()`
2. **Preview** test cases with `preview_tests("function_name")`
3. **Implement** your solution as `student_function_name`
4. **Test** with `autograder("function_name")`
5. **Iterate** based on feedback until all tests pass
6. **Benchmark** (optional) with `autograder("function_name", benchmark = TRUE)`

## Step-by-Step Guide

### Step 1: List Available Problems

```{r}
library(autograder)
list_problems()
```

This shows all functions available for testing in your course.

### Step 2: Preview Test Cases

Before writing code, understand what's expected:

```{r}
preview_tests("fibonacci")
```

This shows:
- **Test descriptions** - What each test checks
- **Input values** - What arguments are passed
- **Point values** - How much each test is worth
- **Hidden tests** - Existence noted, but details hidden

### Step 3: Create Your Function

Name your function with the `student_` prefix:

```{r}
# For the "fibonacci" problem, create student_fibonacci
student_fibonacci <- function(n) {
  # Your implementation here
}
```

### Step 4: Run the Autograder

```{r}
result <- autograder("fibonacci")
```

The autograder returns a results object:
```{r}
result$passed     # Number of tests passed
result$failed     # Number of tests failed
result$total      # Total tests
result$score      # Points earned
result$max_score  # Maximum points
result$pass_rate  # Percentage passed
```

### Step 5: Interpret Feedback

#### Passing Test
```
[Test 1] Base case: n = 1 (1 pt): PASS
```

#### Failing Test
```
[Test 2] Small input: n = 5 (2 pt): FAIL
  Input:    list(5)
  Expected: c(1, 1, 2, 3, 5)
  Got:      c(1, 1, 2, 3, 4)

  Feedback:
    * Differences at positions: 5
```

#### Type Error
```
[Test 1] Base case (1 pt): FAIL (Type Error)
  Expected type: numeric
  Got type: character
```

#### Runtime Error
```
[Test 1] Base case (1 pt): FAIL (Error)
  Input: list(5)
  Error: object 'x' not found
```

### Step 6: Debug and Retry

Use the feedback to fix your code:

```{r}
# Test your function manually with the failing input
student_fibonacci(5)
# Compare with expected output
# Fix the bug
# Run autograder again
autograder("fibonacci")
```

## Tips for Success

### 1. Start Simple

Test your function manually before running the autograder:

```{r}
# Test edge cases first
student_fibonacci(0)
student_fibonacci(1)
student_fibonacci(2)

# Then larger inputs
student_fibonacci(10)
```

### 2. Read Error Messages Carefully

The autograder provides specific feedback:
- **Position differences** tell you exactly where output differs
- **Type errors** indicate wrong return type
- **Runtime errors** show R error messages from your function

### 3. Handle Edge Cases

Many problems have edge cases:
- Empty input (`n = 0`)
- Single element (`n = 1`)
- Negative numbers
- Very large inputs

### 4. Use Verbose Mode

Get detailed output for debugging:

```{r}
autograder("fibonacci", verbose = TRUE, show_hints = TRUE)
```

### 5. Check Your Return Type

Common type issues:
```{r}
# Wrong: returning string instead of number
return("5")

# Right: returning number
return(5)

# Wrong: returning list instead of vector
return(list(1, 2, 3))

# Right: returning vector
return(c(1, 2, 3))
```

## Common Errors and Solutions

### "Function not found"
```
Error: Function 'student_fibonacci' not found in your environment.
```
**Solution:** Make sure your function is named correctly with `student_` prefix.

### "Type mismatch"
```
Type mismatch: Expected numeric but got character
```
**Solution:** Check that you're returning numbers, not strings.

### "Length mismatch"
```
Length mismatch: Expected length 10 but got 9
```
**Solution:** Check your loop bounds for off-by-one errors.

### "Network error"
```
No internet connection detected.
```
**Solution:** The autograder needs internet to fetch test cases. Check your connection.

## Working with Data Files

Some problems require your function to analyze data from files (CSV, Excel, RDS).
The autograder handles data loading automatically!

### How It Works

When a test uses data files:
1. The autograder downloads the data file
2. Loads it into R (as data frame, list, etc.)
3. Passes the loaded data to your function

**Your function receives the data directly, not a file path!**

### Example

```{r}
# ✅ CORRECT - data is already a data frame
student_analyze <- function(data, stat = "mean") {
  sapply(data[sapply(data, is.numeric)], 
         switch(stat, mean = mean, sum = sum))
}

# ❌ WRONG - don't try to read the file
student_analyze <- function(data, stat = "mean") {
  df <- read.csv(data)  # data is NOT a filename!
  # ...
}
```

For more details, see [Working with Data Files](data-files.html).

## Performance Benchmarking

After passing all tests, you can benchmark your code to see how fast it is:

### Basic Benchmark

```{r}
# Run autograder with benchmark enabled
result <- autograder("fibonacci", benchmark = TRUE)
```

This runs your function multiple times and compares execution time to the 
reference solution. You'll see output like:

```
=== Performance Benchmark ===
Running 50 benchmark iterations...

Your time:       0.000123 seconds (median)
Reference time:  0.000145 seconds (median)
Performance:     0.85x (FASTER)
```

### Understanding the Results

| Performance Ratio | Verdict | Meaning |
|------------------|---------|---------|
| < 0.9x | FASTER | Your code is faster than the reference |
| 0.9x - 1.1x | COMPARABLE | Similar performance |
| 1.1x - 2.0x | SLOWER | Somewhat slower |
| 2.0x - 5.0x | MUCH SLOWER | Needs optimization |
| > 5.0x | VERY SLOW | Significant optimization needed |

### Benchmark Bonus Points

Your instructor may enable performance bonuses. If so, you can earn extra 
points for fast implementations:

```{r}
# With 10% max bonus for performance
result <- autograder("fibonacci", benchmark = TRUE, benchmark_bonus = 10)

# If your code is faster, you might see:
# ☆ PERFORMANCE BONUS: +1.5 points (15% of max 10%)
```

The bonus scales based on how much faster your implementation is:
- 2x faster (ratio = 0.5) → Full bonus
- 10% faster (ratio = 0.9) → Small bonus
- Not faster (ratio ≥ 1.0) → No bonus

### Customizing Benchmark Runs

```{r}
# More runs = more accurate timing, but takes longer
result <- autograder("fibonacci", 
                     benchmark = TRUE, 
                     benchmark_runs = 100)
```

**Note:** Benchmarks only run if all tests pass first.

## Getting Help

If you're stuck:
1. Re-read the test case descriptions with `preview_tests()`
2. Test your function manually with simple inputs
3. Check the function requirements/documentation
4. Ask your instructor for help
