# Autograder R Package - Developer Guide

[![Version](https://img.shields.io/badge/version-0.3.0-blue)](https://github.com/KingSSIBAL/R-Function-checker)
[![Tests](https://img.shields.io/badge/tests-325%20passing-success)](https://github.com/KingSSIBAL/R-Function-checker)
[![Coverage](https://img.shields.io/badge/coverage-60.18%25-green)](https://github.com/KingSSIBAL/R-Function-checker)
[![R-CMD-check](https://img.shields.io/badge/R--CMD--check-passing-brightgreen)](https://github.com/KingSSIBAL/R-Function-checker)

> **Developer documentation** for contributing to the autograder package. Focus on architecture, encryption implementation, testing, and performance optimization.

## ğŸ‘¨â€ğŸ’» For Developers

This guide is for **developers** who want to:
- ğŸ” **Enable the AES encryption** (currently disabled)
- ğŸš€ Contribute new features
- ğŸ› Fix bugs or improve performance
- ğŸ“š Understand the codebase architecture
- ğŸ§ª Add tests and improve coverage
- âš¡ Optimize C++ performance


---

## ğŸ” PRIORITY: Implementing Encryption (Action Required)

### âš ï¸ Current Status

The package has **fully implemented AES-inspired encryption** but it's **currently disabled** in production:

```cpp
// src/autograder.cpp - Line ~60
std::string get_github_base() {
    // TODO: In production, decrypt URL parts:
    // std::string key = derive_key();
    // std::string part1 = simple_decrypt(ENC_PART_1, key);
    // std::string part2 = simple_decrypt(ENC_PART_2, key);
    // return part1 + part2 + "/KingSSIBAL/R-Function-checker/main/repo";

    // CURRENTLY RETURNING PLAINTEXT:
    return "https://raw.githubusercontent.com/KingSSIBAL/R-Function-checker/main/repo";
}
```

### ğŸ¯ Why Enable Encryption?

**Security Benefits:**
- âœ… Obfuscates test case URLs from casual inspection
- âœ… Prevents easy URL modification by students
- âœ… Adds layer of defense-in-depth
- âœ… Makes reverse-engineering significantly harder

**Educational Benefits:**
- âœ… Demonstrates real cryptography concepts
- âœ… Shows security best practices
- âœ… Engages security-minded students
- âœ… Provides practical crypto implementation example

### ğŸš€ How to Enable Encryption (15-20 minutes)

#### Step 1: Generate Encrypted URL Components (Offline)

Create a script `tools/encrypt_urls.R`:

```r
# tools/encrypt_urls.R - Run this ONCE offline

# Load the package
devtools::load_all()

# The URL to encrypt
url <- "https://raw.githubusercontent.com/KingSSIBAL/R-Function-checker/main/repo"

# Split into components
parts <- list(
  protocol = "https://",
  domain = "raw.githubusercontent.com",
  path = "/KingSSIBAL/R-Function-checker/main/repo"
)

# Source the encryption helper
source("tools/encrypt_helper.R")

# Encrypt each part
key <- derive_key_r()  # R version of C++ key derivation

encrypted_parts <- lapply(parts, function(part) {
  encrypt_string(part, key)
})

# Convert to C++ byte array format
for (name in names(encrypted_parts)) {
  bytes <- as.raw(charToRaw(encrypted_parts[[name]]))

  cat(sprintf("static const uint8_t ENC_%s[] = {", toupper(name)))
  cat(paste(sprintf("0x%02x", bytes), collapse = ", "))
  cat("};
")
  cat(sprintf("static const size_t ENC_%s_LEN = %d;

", 
              toupper(name), length(bytes)))
}
```

Create the helper `tools/encrypt_helper.R`:

```r
# tools/encrypt_helper.R

# AES S-box (same as C++)
sbox <- c(
  0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 
  0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0,
  # ... rest of S-box (copy from autograder.cpp)
)

# R implementation of key derivation (matches C++)
derive_key_r <- function() {
  key_base <- "AUTOGRADER_SECURE_KEY_2025"
  var1 <- "v0.2.0"
  var2 <- "R-FUNC-CHK"

  derived <- paste0(key_base, var1, var2)

  # Apply S-box transformation
  key <- ""
  for (i in 1:nchar(derived)) {
    byte <- utf8ToInt(substr(derived, i, i))
    key <- paste0(key, rawToChar(as.raw(sbox[byte + 1])))
  }

  substr(key, 1, 32)
}

# Encrypt string (XOR with key after S-box)
encrypt_string <- function(text, key) {
  result <- raw(nchar(text))
  key_bytes <- charToRaw(key)

  for (i in 1:nchar(text)) {
    byte <- utf8ToInt(substr(text, i, i))
    # XOR with key, THEN apply S-box (reverse of decrypt)
    encrypted <- bitwXor(byte, as.integer(key_bytes[(i-1) %% length(key_bytes) + 1]))

    # Find inverse S-box position
    inv_pos <- which(sbox == encrypted) - 1
    result[i] <- as.raw(inv_pos)
  }

  rawToChar(result)
}
```

#### Step 2: Run the Encryption Script

```r
# In R console
setwd("autograder")
source("tools/encrypt_urls.R")

# Output will be C++ byte arrays like:
# static const uint8_t ENC_PROTOCOL[] = {0x8e, 0x9a, 0x8c, ...};
# static const size_t ENC_PROTOCOL_LEN = 8;
```

#### Step 3: Update C++ Code

Replace in `src/autograder.cpp`:

```cpp
// ============================================================================
// ENCRYPTED URL COMPONENTS (Generated offline with tools/encrypt_urls.R)
// ============================================================================

// Protocol: "https://"
static const uint8_t ENC_PROTOCOL[] = {
    0x8e, 0x9a, 0x8c, 0x9e, 0xae, 0xb2, 0xaf, 0xaf
};
static const size_t ENC_PROTOCOL_LEN = 8;

// Domain: "raw.githubusercontent.com"
static const uint8_t ENC_DOMAIN[] = {
    0x9d, 0x85, 0xa3, 0xae, 0x87, 0x91, 0x8c, 0x9a, 0x8f, 0xa9, 0x8c, 0x9a,
    0x93, 0x9f, 0x86, 0x9a, 0x9b, 0xa1, 0x9f, 0x86, 0xa9, 0x87, 0xa8, 0x97
};
static const size_t ENC_DOMAIN_LEN = 24;

// Path: "/KingSSIBAL/R-Function-checker/main/repo"
static const uint8_t ENC_PATH[] = {
    0xaf, 0x5a, 0x96, 0x9b, 0x98, 0x62, 0x62, 0x56, 0x45, 0x4f, 0xaf, 0x61,
    0xaf, 0x4b, 0xa9, 0x9b, 0x87, 0xa9, 0x96, 0x9f, 0x9b, 0xaf, 0x87, 0x9a,
    0x87, 0x98, 0x87, 0x9d, 0xaf, 0x97, 0x85, 0x96, 0x9b, 0xaf, 0x9d, 0x87,
    0xa0, 0x9f
};
static const size_t ENC_PATH_LEN = 38;

/**
 * @brief Decrypt and assemble GitHub base URL
 * 
 * NOW USES ENCRYPTION: Decrypts URL components at runtime
 */
std::string get_github_base() {
    std::string key = derive_key();

    // Decrypt each component
    std::string protocol = simple_decrypt(
        std::string(reinterpret_cast<const char*>(ENC_PROTOCOL), ENC_PROTOCOL_LEN),
        key
    );

    std::string domain = simple_decrypt(
        std::string(reinterpret_cast<const char*>(ENC_DOMAIN), ENC_DOMAIN_LEN),
        key
    );

    std::string path = simple_decrypt(
        std::string(reinterpret_cast<const char*>(ENC_PATH), ENC_PATH_LEN),
        key
    );

    // Assemble complete URL
    return protocol + domain + path;
}
```

#### Step 4: Test Encryption Works

```r
# Rebuild package with encryption enabled
devtools::clean_dll()
devtools::load_all()

# Test URL decryption
# Should still work exactly the same as before
library(autograder)
list_problems()  # Should fetch successfully

# If this works, encryption is enabled! âœ…
```

#### Step 5: Verify Binary Obfuscation

```bash
# Check that URLs are NOT in plaintext in compiled binary

# On Linux/Mac:
strings autograder/src/autograder.so | grep "githubusercontent"
# Should return: NOTHING (URL is encrypted)

# On Windows:
strings autograder/src/autograder.dll | grep "githubusercontent"
# Should return: NOTHING (URL is encrypted)

# If you see the URL, encryption is not working
# If you see nothing, SUCCESS! âœ…
```

### ğŸ” Encryption Implementation Details

#### Current Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. OFFLINE (Developer Machine)                              â”‚
â”‚    â”œâ”€ Run: tools/encrypt_urls.R                            â”‚
â”‚    â”œâ”€ Generate: Encrypted byte arrays                       â”‚
â”‚    â””â”€ Copy: Paste into autograder.cpp                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Build & Compile
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. COMPILED BINARY (.so/.dll)                               â”‚
â”‚    â”œâ”€ Contains: Encrypted byte arrays                       â”‚
â”‚    â”œâ”€ Contains: Decryption functions (derive_key, decrypt)  â”‚
â”‚    â””â”€ No plaintext URLs visible in binary                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ Runtime
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. RUNTIME (Student's Computer)                             â”‚
â”‚    â”œâ”€ Call: get_github_base()                              â”‚
â”‚    â”œâ”€ Derives: 256-bit key from constants                   â”‚
â”‚    â”œâ”€ Decrypts: URL components                              â”‚
â”‚    â””â”€ Returns: Full URL for fetching tests                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Security Analysis

**Threat Model:**

| Attack Vector | Protected? | How |
|--------------|-----------|-----|
| Casual inspection | âœ… Yes | Binary contains encrypted bytes only |
| String search | âœ… Yes | No plaintext URLs in binary |
| Simple XOR crack | âœ… Yes | S-box provides non-linearity |
| Decompilation | âš ï¸ Partial | C++ can be decompiled with effort |
| Reverse engineering | âš ï¸ Difficult | Need to understand algorithm + find key |
| Source code access | âŒ No | Open source - can read on GitHub |

**Realistic Protection Level:**
- Against students: â­â­â­â­â­ (Very effective)
- Against security researchers: â­â­â­ (Slows them down)
- Against determined attackers: â­â­ (Can be broken with effort)

**Assessment:** Perfect for educational use case.

#### Encryption Algorithm Breakdown

```
Encryption (offline):
  plaintext â†’ XOR with key â†’ find inverse S-box position â†’ ciphertext

Decryption (runtime):
  ciphertext â†’ S-box substitution â†’ XOR with key â†’ plaintext

Key Derivation:
  base_string + version + project_id â†’ S-box transform â†’ 256-bit key

Why this works:
  1. S-box provides non-linear transformation
  2. Key derivation makes key unpredictable
  3. XOR provides reversibility
  4. 256-bit key space is large (2^256)
```

### ğŸ”¬ Testing Encryption

After implementing, run these tests:

```r
# Test 1: Functionality test
devtools::load_all()
library(autograder)
list_problems()  # Should work exactly as before

# Test 2: Binary inspection test
system("strings src/autograder.so | grep raw.githubusercontent")
# Should return: EMPTY (no matches)

# Test 3: Performance test
system.time({
  for (i in 1:100) {
    autograder:::get_github_base()
  }
})
# Should be <0.1s (decryption is fast)

# Test 4: Consistency test
url1 <- autograder:::get_github_base()
url2 <- autograder:::get_github_base()
stopifnot(identical(url1, url2))  # Must be deterministic
```

### ğŸ›¡ï¸ Security Enhancements (Future)

**Current Implementation (Good):**
- âœ… S-box substitution
- âœ… XOR cipher
- âœ… Key derivation
- âœ… 256-bit key

**Potential Improvements (Better):**
- ğŸ”² Add salt to key derivation
- ğŸ”² Multiple encryption rounds
- ğŸ”² Different keys for different URL components
- ğŸ”² Time-based key rotation
- ğŸ”² HMAC for integrity verification

**Implementation Priority: LOW**  
**Reason:** Current implementation is sufficient for obfuscation needs. Test cases aren't highly sensitive data.

---

## ğŸ—ï¸ Architecture Overview

### Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AUTOGRADER PACKAGE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   R Layer (~/R/)    â”‚      â”‚  C++ Layer (~/src/) â”‚        â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤        â”‚
â”‚  â”‚                     â”‚      â”‚                     â”‚        â”‚
â”‚  â”‚ â€¢ autograder()      â”‚â—„â”€â”€â”€â”€â”¤â”‚ â€¢ cpp_compare_fast()â”‚        â”‚
â”‚  â”‚   â””â”€ Orchestration  â”‚      â”‚ â€¢ cpp_fetch_*()     â”‚        â”‚
â”‚  â”‚                     â”‚      â”‚ â€¢ derive_key()      â”‚        â”‚
â”‚  â”‚ â€¢ preview_tests()   â”‚      â”‚ â€¢ simple_decrypt()  â”‚        â”‚
â”‚  â”‚   â””â”€ Display        â”‚      â”‚ â€¢ is_valid_*()      â”‚        â”‚
â”‚  â”‚                     â”‚      â”‚                     â”‚        â”‚
â”‚  â”‚ â€¢ list_problems()   â”‚      â”‚ [Performance]       â”‚        â”‚
â”‚  â”‚   â””â”€ Discovery      â”‚      â”‚ â€¢ 10-100x faster    â”‚        â”‚
â”‚  â”‚                     â”‚      â”‚ â€¢ Early termination â”‚        â”‚
â”‚  â”‚ â€¢ provide_feedback()â”‚      â”‚ â€¢ Type-optimized    â”‚        â”‚
â”‚  â”‚   â””â”€ Analysis       â”‚      â”‚                     â”‚        â”‚
â”‚  â”‚                     â”‚      â”‚ [Security]          â”‚        â”‚
â”‚  â”‚ â€¢ validate_*()      â”‚      â”‚ â€¢ Input sanitation  â”‚        â”‚
â”‚  â”‚   â””â”€ Validation     â”‚      â”‚ â€¢ URL encryption    â”‚        â”‚
â”‚  â”‚                     â”‚      â”‚ â€¢ Custom errors     â”‚        â”‚
â”‚  â”‚ â€¢ run_tests_*()     â”‚      â”‚                     â”‚        â”‚
â”‚  â”‚   â””â”€ Parallel/Seq   â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”‚                     â”‚               â–²                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚                      â”‚
â”‚         â”‚                              â”‚ Rcpp Interface       â”‚
â”‚         â”‚ Calls C++ via                â”‚                      â”‚
â”‚         â”‚ .Call() interface            â”‚                      â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                                    â–²
           â”‚ Fetches via HTTPS                  â”‚
           â–¼                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GITHUB REPOSITORY (repo/)                         â”‚
â”‚  â€¢ Test cases stored remotely                                 â”‚
â”‚  â€¢ Fetched at runtime                                         â”‚
â”‚  â€¢ Cached by OS                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

```
Student runs autograder("fibonacci")
           â”‚
           â–¼
[R] Validate inputs
           â”‚
           â–¼
[R] Check internet connectivity
           â”‚
           â–¼
[C++] Validate function_name (sanitization)
           â”‚
           â–¼
[C++] Decrypt URL (derive_key + simple_decrypt)
           â”‚
           â–¼
[C++] Fetch test cases via HTTPS
           â”‚
           â–¼
[R] Parse and load instructor code
           â”‚
           â–¼
[R] Extract function and test_cases
           â”‚
           â–¼
[R] Validate test_cases structure
           â”‚
           â–¼
[R] Run tests (parallel if nâ‰¥10, else sequential)
           â”‚
           â”œâ”€ [R] Execute student_function(input)
           â”œâ”€ [R] Execute instructor_function(input)
           â””â”€ [C++] Compare outputs (cpp_compare_fast)
                    â”‚
                    â–¼
           [R] Generate feedback (analyze differences)
                    â”‚
                    â–¼
           [R] Display results and score
                    â”‚
                    â–¼
           [R] Return results object
```

### Performance Critical Paths

**Hot Paths (Optimize these):**
1. ğŸ”¥ `cpp_compare_fast()` - Called n times per test
2. ğŸ”¥ `run_tests_parallel()` - Main execution loop
3. ğŸ”¥ `format_output()` - Called for every output display

**Cold Paths (Less critical):**
4. â„ï¸ `cpp_fetch_function_content()` - Network I/O dominates
5. â„ï¸ `validate_test_cases()` - One-time per autograder call
6. â„ï¸ `provide_feedback()` - Only for failed tests

---

## ğŸ› ï¸ Development Setup

### Prerequisites

```bash
# System requirements
R >= 3.5.0
C++11 compiler (gcc/clang/MSVC)
git
```

### Quick Setup

```bash
# 1. Clone repository
git clone https://github.com/KingSSIBAL/R-Function-checker.git
cd R-Function-checker/autograder

# 2. Open in RStudio (recommended) or use command line
```

```r
# 3. Install development dependencies
install.packages(c("devtools", "testthat", "roxygen2", "covr", "rcmdcheck"))

# 4. Install package dependencies
devtools::install_deps(dependencies = TRUE)

# 5. Load package in dev mode
devtools::load_all()

# 6. Run tests to verify setup
devtools::test()
# Expected: [ FAIL 0 | WARN 1 | SKIP 3 | PASS 325 ]

# 7. Check package health
devtools::check()
# Expected: 0 errors âœ” | 0 warnings âœ” | 1 note âœ–
```

### Development Workflow

```r
# 1. Make changes to code
# Edit R/autograder.R or src/autograder.cpp

# 2. Rebuild (if changed C++)
devtools::clean_dll()
devtools::load_all()

# 3. Test changes
devtools::test()

# 4. Update documentation
devtools::document()

# 5. Check package
devtools::check()

# 6. Check coverage
covr::package_coverage()

# 7. Build
devtools::build()
```

---

## ğŸ§ª Testing

### Test Organization

```
tests/testthat/
â”œâ”€â”€ test-autograder.R             # Main autograder function (28 tests)
â”œâ”€â”€ test-autograder-coverage.R    # Coverage tests (26 tests)
â”œâ”€â”€ test-autograder-main.R        # Core functionality (16 tests)
â”œâ”€â”€ test-cpp-coverage.R           # C++ edge cases (53 tests)
â”œâ”€â”€ test-cpp-functions.R          # C++ unit tests (26 tests)
â”œâ”€â”€ test-edge-cases.R             # Edge cases (32 tests)
â”œâ”€â”€ test-feedback.R               # Feedback system (22 tests)
â”œâ”€â”€ test-final-coverage.R         # Additional coverage (7 tests)
â”œâ”€â”€ test-format-output.R          # Output formatting (40 tests)
â”œâ”€â”€ test-format-output-advanced.R # Advanced formatting (18 tests)
â”œâ”€â”€ test-integration.R            # Integration tests (20 tests)
â”œâ”€â”€ test-parallel.R               # Parallel execution (11 tests)
â””â”€â”€ test-validation.R             # Input validation (26 tests)

Total: 325 tests, 60.18% coverage
```

### Running Specific Tests

```r
# Run single test file
testthat::test_file("tests/testthat/test-cpp-functions.R")

# Run tests matching pattern
devtools::test(filter = "parallel")

# Run with coverage
covr::test()

# Run in parallel (faster)
devtools::test(parallel = TRUE)
```

### Writing New Tests

**Template:**

```r
# tests/testthat/test-feature.R

test_that("feature works correctly", {
  # Arrange
  input <- prepare_test_data()

  # Act
  result <- your_function(input)

  # Assert
  expect_equal(result, expected)
  expect_type(result, "list")
  expect_true("field" %in% names(result))
})

test_that("feature handles edge cases", {
  # Test NULL
  expect_error(your_function(NULL))

  # Test empty
  expect_equal(your_function(character(0)), expected_empty)

  # Test NA
  expect_equal(your_function(NA), expected_na)
})
```

**Best Practices:**
- âœ… One concept per test
- âœ… Descriptive test names
- âœ… Arrange-Act-Assert pattern
- âœ… Test happy path AND edge cases
- âœ… Use expect_* functions
- âœ… Don't use magic numbers

### Current Test Coverage

```r
# Generate coverage report
cov <- covr::package_coverage()
print(cov)

# View in browser
covr::report(cov)

# Find uncovered lines
zero_cov <- covr::zero_coverage(cov)
print(zero_cov)
```

**Current Coverage:**
- `R/autograder.R`: 55.29% (target: 70%)
- `src/autograder.cpp`: 75.97% (âœ… excellent!)
- Overall: 60.18% (target: 70%)

**To improve:**
1. Add tests for error paths
2. Test custom comparison functions
3. Test network error scenarios (requires mocking)
4. Test parallel edge cases

---

## âš¡ Performance Optimization

### Profiling

```r
# Profile code execution
Rprof("profile.out")
autograder("fibonacci")
Rprof(NULL)

# View results
summaryRprof("profile.out")

# Identify bottlenecks
profvis::profvis({
  autograder("fibonacci", use_parallel = FALSE)
})
```

### C++ Optimization Tips

**Current Optimizations:**
- âœ… Early termination in comparisons
- âœ… Type-specific code paths
- âœ… Direct memory access via Rcpp
- âœ… No unnecessary allocations
- âœ… Cache-friendly iteration

**Potential Improvements:**

```cpp
// Optimization 1: SIMD for numeric comparison
#include <immintrin.h>  // AVX2

bool compare_numeric_simd(double* v1, double* v2, size_t n, double tol) {
    // Process 4 doubles at once using AVX2
    __m256d tol_vec = _mm256_set1_pd(tol);

    for (size_t i = 0; i < n; i += 4) {
        __m256d a = _mm256_loadu_pd(&v1[i]);
        __m256d b = _mm256_loadu_pd(&v2[i]);
        __m256d diff = _mm256_sub_pd(a, b);
        // ... SIMD comparison
    }
}
// Potential speedup: 2-4x for large numeric vectors
```

```cpp
// Optimization 2: Parallel comparison for huge vectors
#include <omp.h>

bool compare_openmp(NumericVector v1, NumericVector v2, double tol) {
    bool match = true;
    #pragma omp parallel for reduction(&&:match)
    for (int i = 0; i < v1.size(); i++) {
        if (std::abs(v1[i] - v2[i]) > tol) {
            match = false;
        }
    }
    return match;
}
// Use for vectors > 1 million elements
```

**Note:** Current implementation is already very fast. Only optimize if profiling shows bottlenecks.

### R Optimization Tips

```r
# âŒ Slow: Growing vectors
result <- numeric(0)
for (i in 1:n) {
  result <- c(result, compute(i))  # Reallocates every time!
}

# âœ… Fast: Pre-allocate
result <- numeric(n)  # Allocate once
for (i in 1:n) {
  result[i] <- compute(i)  # Just assign
}

# âŒ Slow: apply() for simple operations
result <- apply(matrix, 1, sum)

# âœ… Fast: Vectorized
result <- rowSums(matrix)

# âŒ Slow: Multiple identical() calls
for (i in 1:n) {
  if (identical(a, b)) { ... }
}

# âœ… Fast: Call once, cache result
is_identical <- identical(a, b)
for (i in 1:n) {
  if (is_identical) { ... }
}
```

---

## ğŸ”Œ API Reference for Developers

### Exported Functions (User-Facing)

```r
autograder(function_name, verbose, show_hidden, show_progress, use_parallel, show_hints)
preview_tests(function_name)
list_problems()
```

### Internal R Functions (Package-Only)

```r
# Validation
validate_test_cases(test_data, function_name)
is_valid_function_name(name)  # R version (C++ is canonical)

# Fetching
fetch_instructor_code(function_name)
extract_instructor_function(instructor_env, function_name)
extract_test_cases(instructor_env, function_name)

# Execution
run_tests_parallel(student_fun, instructor_fun, test_data, tolerance, use_parallel)
run_tests_sequential(student_fun, instructor_fun, test_data, tolerance)

# Feedback
provide_feedback(student_out, expected_out, input_args, hint)
print_feedback(feedback)

# Formatting
format_output(obj, max_length, preserve_structure)

# Errors
network_error(message, call)
function_not_found_error(function_name, call)
test_execution_error(message, test_number, call)

# Operators
`%||%`(x, y)  # NULL coalescing
```

### Exported C++ Functions (via Rcpp)

```cpp
// Comparison
LogicalVector cpp_compare_fast(SEXP obj1, SEXP obj2, double tolerance = 1e-10)
LogicalVector cpp_compare_identical(SEXP obj1, SEXP obj2)  // Legacy

// Fetching
CharacterVector cpp_fetch_function_content(const std::string& function_name)
CharacterVector cpp_fetch_problems_list()
```

### Internal C++ Functions (Not Exported)

```cpp
// Encryption
std::string simple_decrypt(const std::string& encoded, const std::string& key)
std::string derive_key()
std::string get_github_base()

// Validation
bool is_valid_function_name(const std::string& name)

// Errors (C++ exceptions)
class NetworkError : public std::runtime_error
class FunctionNotFoundError : public std::runtime_error
class InvalidInputError : public std::runtime_error
```

---

## ğŸ› Debugging

### Common Development Issues

**Issue 1: C++ changes not taking effect**

```r
# Solution: Clean and rebuild
devtools::clean_dll()
devtools::load_all()
```

**Issue 2: Tests fail after C++ changes**

```bash
# Check compilation errors
R CMD INSTALL --preclean .

# View detailed errors
devtools::load_all(compile = TRUE, recompile = TRUE)
```

**Issue 3: Segfault in C++ code**

```r
# Debug with gdb (Linux/Mac)
R -d gdb
# (gdb) run
# > devtools::load_all()
# > autograder("fibonacci")
# (gdb) bt  # Backtrace when crash occurs

# Debug with lldb (Mac)
R -d lldb

# On Windows: Use Visual Studio debugger
```

**Issue 4: Memory leaks**

```r
# Check for memory issues
devtools::test()  # Run multiple times
# If memory keeps growing, you have a leak

# Use valgrind (Linux)
R -d valgrind --leak-check=full
```

### Debugging Tools

```r
# R debugging
debug(autograder)           # Step through R code
browser()                    # Breakpoint
traceback()                  # See call stack after error

# C++ debugging  
Rcpp::sourceCpp("src/autograder.cpp", verbose = TRUE)  # See compilation

# Performance profiling
profvis::profvis({
  autograder("fibonacci")
})

# Memory profiling
profmem::profmem({
  autograder("fibonacci")
})
```

---

## ğŸ“š Adding New Features

### Feature: Add Custom Error Type

**Step 1:** Add C++ exception class

```cpp
// In src/autograder.cpp
class TimeoutError : public std::runtime_error {
public:
    explicit TimeoutError(const std::string& msg) : std::runtime_error(msg) {}
};
```

**Step 2:** Add R error constructor

```r
# In R/autograder.R
timeout_error <- function(message, call = NULL) {
  structure(
    list(message = message, call = call),
    class = c("timeout_error", "error", "condition")
  )
}
```

**Step 3:** Use in code

```cpp
// In C++
if (elapsed_time > timeout) {
    throw TimeoutError("Operation timed out after 30 seconds");
}
```

```r
# In R
tryCatch(
  operation(),
  timeout_error = function(e) {
    cat("Operation timed out. Try a simpler input.\n")
  }
)
```

**Step 4:** Add tests

```r
test_that("timeout is detected", {
  expect_error(
    slow_operation(),
    class = "timeout_error"
  )
})
```

### Feature: Add New Comparison Type

**Step 1:** Add C++ handler

```cpp
// In cpp_compare_fast()
if (type1 == CPLXSXP) {  // Complex numbers
    ComplexVector v1(obj1);
    ComplexVector v2(obj2);

    if (v1.size() != v2.size()) return LogicalVector::create(false);

    for (int i = 0; i < v1.size(); ++i) {
        Rcomplex c1 = v1[i];
        Rcomplex c2 = v2[i];

        double real_diff = std::abs(c1.r - c2.r);
        double imag_diff = std::abs(c1.i - c2.i);

        if (real_diff > tolerance || imag_diff > tolerance) {
            return LogicalVector::create(false);
        }
    }
    return LogicalVector::create(true);
}
```

**Step 2:** Add tests

```r
test_that("cpp_compare_fast handles complex numbers", {
  expect_true(.cpp_compare_fast(1+2i, 1+2i, 1e-10)[1])
  expect_false(.cpp_compare_fast(1+2i, 1+3i, 1e-10)[1])
  expect_true(.cpp_compare_fast(
    c(1+2i, 3+4i), 
    c(1+2i, 3+4i), 
    1e-10
  )[1])
})
```

**Step 3:** Update documentation

```r
#' @param obj1 First R object to compare. Supports: numeric, integer, 
#'   character, logical, complex
```

### Feature: Add Progress Callback

**Step 1:** Add parameter

```r
autograder <- function(..., progress_callback = NULL) {
```

**Step 2:** Call callback

```r
for (i in seq_along(test_results)) {
  # ... process test ...

  if (!is.null(progress_callback)) {
    progress_callback(
      test = i,
      total = n_tests,
      passed = passed,
      failed = failed
    )
  }
}
```

**Step 3:** Document

```r
#' @param progress_callback Optional function(test, total, passed, failed)
#'   called after each test for custom progress tracking
```

---

## ğŸ“Š Code Quality Standards

### Style Guide

**R Code:**
- Follow [tidyverse style guide](https://style.tidyverse.org/)
- Max line length: 80 characters
- Use `<-` for assignment (not `=`)
- Use snake_case for functions and variables

**C++ Code:**
- Follow [Google C++ Style](https://google.github.io/styleguide/cppguide.html)
- Max line length: 100 characters
- Use snake_case for functions
- Use descriptive variable names

**Comments:**
- Function headers: Doxygen/roxygen2 style
- Complex algorithms: Explain the approach
- Magic numbers: Always explain
- Security-critical: Mark with @security tag

### Testing Standards

- âœ… Minimum coverage: 60% (currently at 60.18%)
- âœ… All exported functions: must have tests
- âœ… Edge cases: must be covered
- âœ… Error paths: should be tested
- âœ… Performance: should be benchmarked for critical paths

### Documentation Standards

- âœ… All exported functions: roxygen2 docs
- âœ… All parameters: @param descriptions
- âœ… Return values: @return descriptions
- âœ… Examples: @examples sections
- âœ… Internal functions: @keywords internal

---

## ğŸš€ Release Process

### Version Numbering

Follow [Semantic Versioning](https://semver.org/):
- **Major (x.0.0)**: Breaking changes
- **Minor (0.x.0)**: New features, backward compatible
- **Patch (0.0.x)**: Bug fixes

### Release Checklist

```r
# 1. Update version in DESCRIPTION
# 2. Update NEWS.md
# 3. Update .onAttach() message in R/autograder.R

# 4. Run comprehensive checks
devtools::check()                    # No errors/warnings
devtools::test()                     # All tests pass
covr::package_coverage()             # Coverage acceptable
rhub::check_for_cran()               # CRAN checks (if submitting)

# 5. Update documentation
devtools::document()                 # Regenerate .Rd files
pkgdown::build_site()                # Build website (optional)

# 6. Build package
devtools::build()

# 7. Tag release
# In terminal:
git tag -a v0.3.0 -m "Release version 0.3.0"
git push origin v0.3.0

# 8. Create GitHub release
# Go to GitHub â†’ Releases â†’ Create new release
```

### Pre-Release Testing

```r
# Test on multiple R versions
rhub::check(
  platform = c(
    "windows-x86_64-release",
    "macos-arm64-release",  
    "ubuntu-gcc-release"
  )
)

# Test on different machines
# - Windows 10/11
# - macOS (Intel + ARM)
# - Ubuntu/Debian Linux

# Test with different student code
# - Correct implementations (should pass)
# - Buggy implementations (should fail gracefully)
# - Malicious inputs (should sanitize)
```

---

## ğŸ¤ Contributing Guidelines

### Before Contributing

1. âœ… Open an issue to discuss feature
2. âœ… Fork repository
3. âœ… Create feature branch
4. âœ… Read architecture documentation
5. âœ… Set up development environment

### Pull Request Process

```bash
# 1. Create feature branch
git checkout -b feature/your-feature-name

# 2. Make changes with tests
# Edit code
# Add tests
# Update docs

# 3. Verify quality
devtools::test()                     # All pass
devtools::check()                    # No errors
covr::package_coverage()             # Coverage maintained or improved

# 4. Commit with conventional commits
git commit -m "feat: Add feature description

- Detailed change 1
- Detailed change 2
- Add tests for feature
- Update documentation

Closes #123"

# 5. Push and create PR
git push origin feature/your-feature-name
# Then create PR on GitHub
```

### Commit Message Format

Use [Conventional Commits](https://www.conventionalcommits.org/):

```
feat: Add new comparison type for complex numbers
fix: Correct off-by-one error in parallel execution
docs: Update API reference with new parameters
test: Add edge cases for matrix comparison
perf: Optimize numeric comparison with early termination
refactor: Simplify error handling logic
chore: Update dependencies
```

### Code Review Checklist

Before submitting PR:
- [ ] Tests added for new code
- [ ] Tests pass locally (`devtools::test()`)
- [ ] No R CMD check errors (`devtools::check()`)
- [ ] Coverage maintained or improved
- [ ] Documentation updated (roxygen2)
- [ ] Examples added if new feature
- [ ] DESCRIPTION updated if new dependencies
- [ ] NEWS.md updated
- [ ] Code follows style guide
- [ ] Commit messages follow convention

---

## ğŸ”§ Advanced Topics

### Parallel Execution Internals

**How it works:**

```r
# 1. Create cluster (spawn R processes)
cl <- makeCluster(n_cores)

# 2. Export objects to workers
clusterExport(cl, c("student_fun", "instructor_fun"))

# 3. Each worker runs independently
parLapply(cl, indices, function(i) {
  # Worker process runs this
  # Has own memory space
  # No shared state
  # Return result to main process
})

# 4. Main process collects results
# 5. Stop cluster (kills worker processes)
stopCluster(cl)
```

**Overhead Analysis:**
- Cluster creation: ~100ms
- Object serialization: ~10ms per object
- Result deserialization: ~5ms per result
- Total overhead: ~100-200ms

**Worth it when:**
- Test count â‰¥ 10
- Individual tests take >50ms each
- Multi-core system available

### Custom Comparison Functions

**Interface:**

```r
comparison_fn <- function(student_output, expected_output) {
  # Return: TRUE if match, FALSE otherwise
  # Can use any R functions
  # Has access to both outputs
}
```

**Examples:**

```r
# Ignore attributes
comparison_fn = function(s, e) {
  identical(as.vector(s), as.vector(e))
}

# Fuzzy string matching
comparison_fn = function(s, e) {
  tolower(trimws(s)) == tolower(trimws(e))
}

# Set equality (order doesn't matter)
comparison_fn = function(s, e) {
  setequal(s, e)
}

# Structure equality (values can differ)
comparison_fn = function(s, e) {
  is.data.frame(s) && is.data.frame(e) &&
  identical(names(s), names(e)) &&
  identical(sapply(s, class), sapply(e, class))
}
```

### Error Handling Architecture

```
                  Error Occurs
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  C++ Layer     â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ Try/Catch      â”‚â—„â”€â”€â”€ Custom exception classes
              â”‚ forward_to_r() â”‚      (NetworkError, etc.)
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  R Layer       â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ tryCatch()     â”‚â—„â”€â”€â”€ Custom error constructors
              â”‚ Error message  â”‚      (network_error(), etc.)
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚  User          â”‚
              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
              â”‚ Friendly msg   â”‚â—„â”€â”€â”€ Actionable error messages
              â”‚ Troubleshoot   â”‚      No stack traces exposed
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“– Documentation

### Generating Documentation

```r
# Update .Rd files from roxygen2 comments
devtools::document()

# Build pkgdown website (optional)
pkgdown::build_site()

# Preview specific function
?autograder

# Generate PDF manual
devtools::build_manual()
```

### Documentation Standards

**Function Documentation (roxygen2):**

```r
#' Function title (one line, no period)
#'
#' @description
#' Longer description explaining what the function does,
#' when to use it, and any important caveats.
#'
#' @param param1 Description of parameter 1
#' @param param2 Description of parameter 2
#'
#' @return Description of return value, including structure if complex
#'
#' @details
#' Additional details, algorithm explanation, performance notes
#'
#' @section Section Name:
#' Additional organized information
#'
#' @examples
#' \dontrun{
#' # Example 1
#' result <- function_name(arg1, arg2)
#' 
#' # Example 2
#' result <- function_name(other_args)
#' }
#'
#' @keywords internal  # For internal functions
#' @export             # For exported functions
```

**C++ Documentation (Doxygen-style):**

```cpp
/**
 * @brief Brief one-line description
 * 
 * Longer description explaining purpose, algorithm, and usage.
 * 
 * @param param1 Description of parameter 1
 * @param param2 Description of parameter 2
 * 
 * @return Description of return value
 * 
 * @complexity Time and space complexity analysis
 * @security Security considerations if applicable
 * @performance Performance notes if relevant
 * 
 * @example
 *   result = function_name(arg1, arg2);
 * 
 * @keywords internal
 */
```

---

## ğŸ§° Useful Development Commands

### Daily Development

```r
# Load package
devtools::load_all()

# Run tests
devtools::test()

# Check package
devtools::check()

# Quick check (faster)
devtools::check(document = FALSE, args = "--no-tests")
```

### Code Quality

```r
# Check style
lintr::lint_package()

# Format code
styler::style_pkg()

# Spell check
spelling::spell_check_package()

# Check for potential issues
goodpractice::gp()
```

### Performance

```r
# Benchmark
bench::mark(
  old_version = old_function(input),
  new_version = new_function(input),
  iterations = 1000
)

# Profile
profvis::profvis({
  autograder("fibonacci")
})

# Memory
pryr::object_size(result)
```

### Coverage

```r
# Package coverage
covr::package_coverage()

# File coverage
covr::file_coverage("R/autograder.R")

# Function coverage  
covr::function_coverage("autograder")

# Report
covr::report()
```

---

## ğŸ“¦ Package Metadata

### DESCRIPTION File

```dcf
Package: autograder
Title: Automated Grading for R Programming Assignments
Version: 0.3.0
Authors@R: person("Reijel", "Agub", email = "rcagub@up.edu.ph", 
                  role = c("aut", "cre"))
Description: Automated grading system with parallel execution, intelligent 
    feedback, and secure test case management. Includes AES-inspired 
    encryption and comprehensive error handling.
License: MIT + file LICENSE
Encoding: UTF-8
Roxygen: list(markdown = TRUE)
RoxygenNote: 7.0.0
Imports:
    Rcpp (>= 1.0.0),
    parallel,
    curl,
    utils
LinkingTo: Rcpp
Suggests:
    testthat (>= 3.0.0),
    covr,
    knitr,
    rmarkdown
VignetteBuilder: knitr
URL: https://github.com/KingSSIBAL/R-Function-checker
BugReports: https://github.com/KingSSIBAL/R-Function-checker/issues
```

### Dependencies

**Runtime Dependencies (MUST HAVE):**
- `Rcpp` (>= 1.0.0) - C++ integration
- `parallel` - Multi-core execution
- `curl` - Network checks
- `utils` - File operations

**Development Dependencies (OPTIONAL):**
- `devtools` - Development workflow
- `testthat` - Testing framework
- `roxygen2` - Documentation generation
- `covr` - Coverage analysis
- `lintr` - Code linting
- `styler` - Code formatting

**System Dependencies:**
- C++11 compiler (gcc, clang, or MSVC)
- R â‰¥ 3.5.0
- Internet connection (for test case fetching)

---

## ğŸ¯ Performance Benchmarks

### Comparison Performance

```r
# Setup
library(bench)
vec_small <- 1:100
vec_large <- 1:1000000

# Benchmark
bench::mark(
  R_small = identical(vec_small, vec_small),
  Cpp_small = .cpp_compare_fast(vec_small, vec_small, 1e-10),
  R_large = identical(vec_large, vec_large),
  Cpp_large = .cpp_compare_fast(vec_large, vec_large, 1e-10),
  iterations = 100
)
```

**Results:**

| Operation | Median Time | Memory | Speedup |
|-----------|-------------|--------|---------|
| R (100 elements) | 0.5ms | 0B | - |
| C++ (100 elements) | 0.05ms | 0B | **10x** |
| R (1M elements) | 150ms | 0B | - |
| C++ (1M elements) | 2ms | 0B | **75x** |

### Parallel Performance

```r
# Benchmark parallel vs sequential
n_tests <- 20

bench::mark(
  sequential = run_tests_sequential(s_fun, i_fun, test_data, 1e-10),
  parallel = run_tests_parallel(s_fun, i_fun, test_data, 1e-10, TRUE),
  iterations = 10
)
```

**Results (4-core system):**

| Method | Median Time | Speedup |
|--------|-------------|---------|
| Sequential | 2.5s | - |
| Parallel (2 cores) | 1.5s | 1.7x |
| Parallel (4 cores) | 1.0s | 2.5x |

---

## ğŸ› Known Issues & Limitations

### Current Limitations

1. **Encryption Not Enabled**
   - Status: Implemented but not active
   - Impact: URLs visible in binary
   - Priority: Medium (see implementation guide above)
   - Timeline: Next version (0.4.0)

2. **No Time Limits**
   - Status: Not implemented
   - Impact: Infinite loops hang
   - Priority: Medium
   - Workaround: Use R timeout mechanisms

3. **No Memory Limits**
   - Status: Not implemented
   - Impact: Memory-intensive student code can crash
   - Priority: Low
   - Workaround: Monitor student code

4. **Single Repository**
   - Status: Hardcoded to one GitHub repo
   - Impact: Can't easily use multiple repos
   - Priority: Low
   - Workaround: Fork and modify

### Planned Features (Roadmap)

**v0.4.0 (Next Release):**
- [ ] Enable URL encryption
- [ ] Add time limits per test
- [ ] Improve error messages further
- [ ] Add more C++ comparison types (complex, dates)

---

## ğŸ“ Developer Support

### Getting Help

**Technical Questions:**
- Email: rcagub@up.edu.ph
- GitHub Issues: [Open issue](https://github.com/KingSSIBAL/R-Function-checker/issues)
- GitHub Discussions: [Start discussion](https://github.com/KingSSIBAL/R-Function-checker/discussions)

**Code Reviews:**
- Open a draft PR for early feedback
- Tag @KingSSIBAL for review
- Response time: Usually 24-48 hours

**Bug Reports:**

Include:
1. Description of bug
2. Minimal reproducible example
3. Expected vs actual behavior
4. Session info (`sessionInfo()`)
5. Package version

**Feature Requests:**

Include:
1. Use case description
2. Proposed API
3. Why existing features don't suffice
4. Willingness to implement

### Community

- **Slack/Discord:** (Coming soon)
- **Monthly Dev Calls:** (Coming soon)
- **Office Hours:** Email to schedule

---

## ğŸ† Contributor Recognition

### Contributors

Want your name here? Submit a PR!

**Core Contributors:**
- Reijel Agub (@KingSSIBAL) - Original author

**Feature Contributors:**
- (Your name could be here!)

**Bug Fixers:**
- (Your name could be here!)

**Security Researchers:**
- (Your name could be here! - Break the encryption)

---

## ğŸ“„ License

MIT License Â© 2025 Reijel Agub

```
Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.
```

See [LICENSE](../LICENSE) for full text.

---

## ğŸ”— Additional Resources

### Documentation
- **[Project Overview](../README.md)** - Main README
- **[Instructor Guide](../repo/README.md)** - Creating test cases
- **[Student Guide](../docs/student-guide.md)** - Using the package

### External Resources
- [Rcpp Documentation](https://www.rcpp.org/)
- [R Packages Book](https://r-pkgs.org/)
- [Advanced R](https://adv-r.hadley.nz/)
- [Writing R Extensions](https://cran.r-project.org/doc/manuals/r-release/R-exts.html)

### Related Projects
- [gradethis](https://github.com/rstudio/gradethis) - RStudio's autograder
- [learnr](https://rstudio.github.io/learnr/) - Interactive tutorials
- [testthat](https://testthat.r-lib.org/) - Testing framework

---

## ğŸ¯ Quick Reference

### Essential Commands

```r
# Development
devtools::load_all()        # Load package
devtools::test()            # Run tests
devtools::check()           # Check package
devtools::document()        # Update docs

# Quality
covr::package_coverage()    # Coverage
lintr::lint_package()       # Linting
goodpractice::gp()          # Best practices

# Performance
profvis::profvis({...})     # Profile
bench::mark(...)            # Benchmark

# Release
devtools::build()           # Build package
devtools::install()         # Install locally
rhub::check_for_cran()      # CRAN checks
```

### File Locations

```
autograder/
â”œâ”€â”€ R/autograder.R              # Main R code (~650 lines)
â”œâ”€â”€ src/autograder.cpp          # C++ code (~280 lines)
â”œâ”€â”€ tests/testthat/             # Test suite (325 tests)
â”œâ”€â”€ man/                        # Generated docs
â”œâ”€â”€ DESCRIPTION                 # Package metadata
â”œâ”€â”€ NAMESPACE                   # Exports
â””â”€â”€ README.md                   # This file
```

### Important Functions to Know

**High-level (R):**
- `autograder()` - Main entry point
- `validate_test_cases()` - Input validation
- `run_tests_parallel()` - Parallel execution

**Low-level (C++):**
- `cpp_compare_fast()` - Comparison engine
- `cpp_fetch_function_content()` - Secure fetch
- `derive_key()` - Key generation
- `simple_decrypt()` - Decryption

---

## ğŸ’¡ Tips for New Developers

### Getting Started

1. **Read the code in this order:**
   - `R/autograder.R` - Start here (main logic)
   - `src/autograder.cpp` - Then here (performance)
   - `tests/testthat/test-*.R` - See examples

2. **Understand the flow:**
   - Input validation â†’ Fetch â†’ Execute â†’ Compare â†’ Feedback

3. **Start small:**
   - Fix a typo
   - Add a test
   - Improve a comment
   - Then tackle bigger features

### Common Gotchas

**C++ Compilation:**
```r
# If Rcpp changes don't take effect:
devtools::clean_dll()  # Force recompile
devtools::load_all()
```

**Test Failures:**
```r
# If tests suddenly fail after changes:
# 1. Check if you changed function signatures
# 2. Update tests accordingly
# 3. Check for global state issues
```

**Documentation:**
```r
# If roxygen2 doesn't update:
devtools::document()  # Regenerate manually
# Check for syntax errors in roxygen comments
```

---

## ğŸ“ Learning Resources

### Understanding the Codebase

**Start with these files:**
1. `R/autograder.R` - Lines 1-100 (setup and errors)
2. `R/autograder.R` - Lines 200-300 (main autograder function)
3. `src/autograder.cpp` - Lines 1-100 (encryption)
4. `src/autograder.cpp` - Lines 150-250 (comparison)

**Key Concepts to Understand:**
- Rcpp basics (how R calls C++)
- Parallel computing in R
- S3 error classes
- Roxygen2 documentation
- Testthat framework

### Recommended Reading

**For Rcpp:**
- [Rcpp Quick Reference](https://cran.r-project.org/web/packages/Rcpp/vignettes/Rcpp-quickref.pdf)
- [Seamless R and C++ Integration](https://www.amazon.com/Seamless-Integration-Rcpp-Dirk-Eddelbuettel/dp/1461468671)

**For R Packages:**
- [R Packages (2nd ed)](https://r-pkgs.org/) by Hadley Wickham
- [Advanced R](https://adv-r.hadley.nz/) by Hadley Wickham

**For Testing:**
- [testthat Documentation](https://testthat.r-lib.org/)
- [Testing Chapter in R Packages](https://r-pkgs.org/testing-basics.html)

---

## ğŸ“Š Code Statistics

### Package Metrics

- **R Code:** 650 lines
- **C++ Code:** 280 lines
- **Test Code:** 2,000+ lines
- **Comment Ratio:** 40%
- **Documentation:** 500+ lines
- **Test Coverage:** 60.18%

### Test Distribution

| Test File | Tests | Focus |
|-----------|-------|-------|
| test-autograder.R | 28 | Main functionality |
| test-cpp-functions.R | 26 | C++ unit tests |
| test-edge-cases.R | 32 | Edge case handling |
| test-parallel.R | 11 | Parallel execution |
| test-validation.R | 26 | Input validation |
| test-feedback.R | 22 | Feedback generation |
| test-format-output.R | 40 | Output formatting |
| Others | 140 | Various coverage |

### Complexity Metrics

```r
# Cyclomatic complexity (lower is better)
autograder(): 15       # Medium (acceptable for main function)
cpp_compare_fast(): 8  # Low (good)
validate_test_cases(): 12  # Medium (acceptable)

# Function length (lines of code)
autograder(): 180      # Long (consider refactoring)
cpp_compare_fast(): 60 # Good
run_tests_parallel(): 40  # Good
```

---

## ğŸš¦ CI/CD (Future)

### Planned GitHub Actions

**`.github/workflows/R-CMD-check.yml`:**
```yaml
name: R-CMD-check

on: [push, pull_request]

jobs:
  R-CMD-check:
    runs-on: ${{ matrix.os }}
    strategy:
      matrix:
        os: [ubuntu-latest, windows-latest, macos-latest]
        r: ['3.5', '4.0', '4.3']

    steps:
      - uses: actions/checkout@v3
      - uses: r-lib/actions/setup-r@v2
        with:
          r-version: ${{ matrix.r }}
      - name: Install dependencies
        run: |
          install.packages("devtools")
          devtools::install_deps(dependencies = TRUE)
      - name: Check
        run: devtools::check()
```

**`.github/workflows/test-coverage.yml`:**
```yaml
name: test-coverage

on: [push, pull_request]

jobs:
  coverage:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: r-lib/actions/setup-r@v2
      - name: Coverage
        run: |
          covr::codecov()
```

---

## ğŸ“ Contact

**Maintainer:** Reijel Agub  
**Email:** rcagub@up.edu.ph  
**GitHub:** [@KingSSIBAL](https://github.com/KingSSIBAL)

**Office Hours:** By appointment (email to schedule)

---

## ğŸ¯ TL;DR for Developers

```r
# Setup (5 minutes)
git clone https://github.com/KingSSIBAL/R-Function-checker.git
cd R-Function-checker/autograder
devtools::install_deps()
devtools::load_all()
devtools::test()  # Should pass

# Enable encryption (15 minutes)
# 1. Run tools/encrypt_urls.R (create if not exists)
# 2. Copy byte arrays to src/autograder.cpp
# 3. Update get_github_base() to decrypt
# 4. Test: strings src/*.so | grep "githubusercontent" â†’ empty
# 5. Done! URLs now encrypted âœ…

# Daily development
devtools::load_all()   # Load changes
devtools::test()       # Run tests  
devtools::check()      # Verify quality

# Before PR
devtools::test()       # All pass
devtools::check()      # No errors
covr::package_coverage()  # Coverage maintained
```

**Priority Tasks:**
1. ğŸ” **Enable encryption** (see above)
2. ğŸ§ª Increase coverage to 70%
3. ğŸ“ Add time limit feature
4. ğŸš€ Optimize parallel overhead

---

**Ready to contribute?** Fork, code, test, submit PR! ğŸš€

**Questions?** Open an issue or email rcagub@up.edu.ph

